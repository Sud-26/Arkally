/**
 * @license
 * Copyright (c) 2018 Dominic Carretto
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/trimox/angular-mdc-web/blob/master/LICENSE
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs/operators"),require("@angular/common"),require("@angular-mdc/web/common"),require("@angular/common/http"),require("@angular/platform-browser"),require("rxjs")):"function"==typeof define&&define.amd?define("@angular-mdc/web/icon",["exports","@angular/core","rxjs/operators","@angular/common","@angular-mdc/web/common","@angular/common/http","@angular/platform-browser","rxjs"],e):e(((t=t||self).ng=t.ng||{},t.ng.web=t.ng.web||{},t.ng.web.icon={}),t.ng.core,t.rxjs.operators,t.ng.common,t.ng.web.common,t.ng.common.http,t.ng.platformBrowser,t.rxjs)}(this,function(t,e,n,o,r,i,s,a){"use strict";var c=function(){function t(){}return t.decorators=[{type:e.Directive,args:[{selector:"[materialIcons]",host:{class:"material-icons"}}]}],t}();function l(t){return Error('Unable to find icon with the name "'+t+'"')}function u(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}function p(t){return Error("The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was \""+t+'".')}function h(t){return Error("The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was \""+t+'".')}var f=function(){return function(t){this.url=null,this.svgElement=null,t.nodeName?this.svgElement=t:this.url=t}}(),g=function(){function t(t,e,n){this._httpClient=t,this._sanitizer=e,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._defaultFontSetClass=["material-icons"],this._document=n}return t.prototype.addSvgIcon=function(t,e){return this.addSvgIconInNamespace("",t,e)},t.prototype.addSvgIconLiteral=function(t,e){return this.addSvgIconLiteralInNamespace("",t,e)},t.prototype.addSvgIconInNamespace=function(t,e,n){return this._addSvgIconConfig(t,e,new f(n))},t.prototype.addSvgIconLiteralInNamespace=function(t,n,o){var r=this._sanitizer.sanitize(e.SecurityContext.HTML,o);if(!r)throw h(o);var i=this._createSvgElementForSingleIcon(r);return this._addSvgIconConfig(t,n,new f(i))},t.prototype.addSvgIconSet=function(t){return this.addSvgIconSetInNamespace("",t)},t.prototype.addSvgIconSetLiteral=function(t){return this.addSvgIconSetLiteralInNamespace("",t)},t.prototype.addSvgIconSetInNamespace=function(t,e){return this._addSvgIconSetConfig(t,new f(e))},t.prototype.addSvgIconSetLiteralInNamespace=function(t,n){var o=this._sanitizer.sanitize(e.SecurityContext.HTML,n);if(!o)throw h(n);var r=this._svgElementFromString(o);return this._addSvgIconSetConfig(t,new f(r))},t.prototype.registerFontClassAlias=function(t,e){return void 0===e&&(e=t),this._fontCssClassesByAlias.set(t,e),this},t.prototype.classNameForFontAlias=function(t){return this._fontCssClassesByAlias.get(t)||t},t.prototype.setDefaultFontSetClass=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._defaultFontSetClass=t,this},t.prototype.getDefaultFontSetClass=function(){return this._defaultFontSetClass},t.prototype.getSvgIconFromUrl=function(t){var o=this,r=this._sanitizer.sanitize(e.SecurityContext.RESOURCE_URL,t);if(!r)throw p(t);var i=this._cachedIconsByUrl.get(r);return i?a.of(v(i)):this._loadSvgIconFromConfig(new f(t)).pipe(n.tap(function(t){return o._cachedIconsByUrl.set(r,t)}),n.map(function(t){return v(t)}))},t.prototype.getNamedSvgIcon=function(t,e){void 0===e&&(e="");var n=_(e,t),o=this._svgIconConfigs.get(n);if(o)return this._getSvgFromConfig(o);var r=this._iconSetConfigs.get(e);return r?this._getSvgFromIconSetConfigs(t,r):a.throwError(l(n))},t.prototype.ngOnDestroy=function(){this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()},t.prototype._getSvgFromConfig=function(t){return t.svgElement?a.of(v(t.svgElement)):this._loadSvgIconFromConfig(t).pipe(n.tap(function(e){return t.svgElement=e}),n.map(function(t){return v(t)}))},t.prototype._getSvgFromIconSetConfigs=function(t,o){var r=this,i=this._extractIconWithNameFromAnySet(t,o);if(i)return a.of(i);var s=o.filter(function(t){return!t.svgElement}).map(function(t){return r._loadSvgIconSetFromConfig(t).pipe(n.catchError(function(n){var o=r._sanitizer.sanitize(e.SecurityContext.RESOURCE_URL,t.url);return console.error("Loading icon set URL: "+o+" failed: "+n.message),a.of(null)}))});return a.forkJoin(s).pipe(n.map(function(){var e=r._extractIconWithNameFromAnySet(t,o);if(!e)throw l(t);return e}))},t.prototype._extractIconWithNameFromAnySet=function(t,e){for(var n=e.length-1;n>=0;n--){var o=e[n];if(o.svgElement){var r=this._extractSvgIconFromSet(o.svgElement,t);if(r)return r}}return null},t.prototype._loadSvgIconFromConfig=function(t){var e=this;return this._fetchUrl(t.url).pipe(n.map(function(t){return e._createSvgElementForSingleIcon(t)}))},t.prototype._loadSvgIconSetFromConfig=function(t){var e=this;return t.svgElement?a.of(t.svgElement):this._fetchUrl(t.url).pipe(n.map(function(n){return t.svgElement||(t.svgElement=e._svgElementFromString(n)),t.svgElement}))},t.prototype._createSvgElementForSingleIcon=function(t){var e=this._svgElementFromString(t);return this._setSvgAttributes(e),e},t.prototype._extractSvgIconFromSet=function(t,e){var n=t.querySelector("#"+e);if(!n)return null;var o=n.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o));var r=this._svgElementFromString("<svg></svg>");return r.appendChild(o),this._setSvgAttributes(r)},t.prototype._svgElementFromString=function(t){var e=this._document.createElement("DIV");e.innerHTML=t;var n=e.querySelector("svg");if(!n)throw Error("<svg> tag not found");var o=n.getAttribute("viewBox");return o&&n.setAttribute("viewBox",o),n},t.prototype._toSvgElement=function(t){for(var e=this._svgElementFromString("<svg></svg>"),n=0;n<t.childNodes.length;n++)t.childNodes[n].nodeType===this._document.ELEMENT_NODE&&e.appendChild(t.childNodes[n].cloneNode(!0));return e},t.prototype._setSvgAttributes=function(t){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),t},t.prototype._fetchUrl=function(t){var o=this;if(!this._httpClient)throw u();if(null==t)throw Error('Cannot fetch icon from URL "'+t+'".');var r=this._sanitizer.sanitize(e.SecurityContext.RESOURCE_URL,t);if(!r)throw p(t);var i=this._inProgressUrlFetches.get(r);if(i)return i;var s=this._httpClient.get(r,{responseType:"text"}).pipe(n.finalize(function(){return o._inProgressUrlFetches.delete(r)}),n.share());return this._inProgressUrlFetches.set(r,s),s},t.prototype._addSvgIconConfig=function(t,e,n){return this._svgIconConfigs.set(_(t,e),n),this},t.prototype._addSvgIconSetConfig=function(t,e){var n=this._iconSetConfigs.get(t);return n?n.push(e):this._iconSetConfigs.set(t,[e]),this},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:i.HttpClient,decorators:[{type:e.Optional}]},{type:s.DomSanitizer},{type:void 0,decorators:[{type:e.Optional},{type:e.Inject,args:[o.DOCUMENT]}]}]},t.ngInjectableDef=e.defineInjectable({factory:function(){return new t(e.inject(i.HttpClient,8),e.inject(s.DomSanitizer),e.inject(o.DOCUMENT,8))},token:t,providedIn:"root"}),t}();function d(t,e,n,o){return t||new g(e,n,o)}var m={provide:g,deps:[[new e.Optional,new e.SkipSelf,g],[new e.Optional,i.HttpClient],s.DomSanitizer,[new e.Optional,o.DOCUMENT]],useFactory:d};function v(t){return t.cloneNode(!0)}function _(t,e){return t+":"+e}function I(){var t=e.inject(o.DOCUMENT),n=t?t.location:null;return{getPathname:function(){return n?n.pathname+n.search:""}}}var S=new e.InjectionToken("mdc-icon-location",{providedIn:"root",factory:I}),y=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],C=y.map(function(t){return"["+t+"]"}).join(", "),E=/^url\(['"]?#(.*?)['"]?\)$/,b=function(){function t(t,e,n,o){this.elementRef=t,this._iconRegistry=e,this._location=o,this._previousFontSetClass=[],this._inline=!1,this.role="img",this.tabIndex=null,this._fontSet="",this._fontIcon="",this._clickable=!1,n||this._getHostElement().setAttribute("aria-hidden","true")}return Object.defineProperty(t.prototype,"inline",{get:function(){return this._inline},set:function(t){this._inline=r.toBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSet",{get:function(){return this._fontSet},set:function(t){this._fontSet=this._cleanupFontValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontIcon",{get:function(){return this._fontIcon},set:function(t){this._fontIcon=this._cleanupFontValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clickable",{get:function(){return this._clickable},set:function(t){this._clickable=r.toBoolean(t),this._clickable?(this.tabIndex=0,this.role="button"):(this.tabIndex=null,this.role=null)},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewChecked=function(){var t=this._elementsWithExternalReferences;if(t&&this._location&&t.size){var e=this._location.getPathname();e!==this._previousPath&&(this._previousPath=e,this._prependPathToReferences(e))}},t.prototype.ngOnDestroy=function(){this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()},t.prototype._splitIconName=function(t){if(!t)return["",""];var e=t.split(":");switch(e.length){case 1:return["",e[0]];case 2:return e;default:throw Error('Invalid icon name: "'+t+'"')}},t.prototype.ngOnChanges=function(t){var e=this;if(t.svgIcon)if(this.svgIcon){var o=this._splitIconName(this.svgIcon),r=o[0],i=o[1];this._iconRegistry.getNamedSvgIcon(i,r).pipe(n.take(1)).subscribe(function(t){return e._setSvgElement(t)},function(t){return console.log("Error retrieving icon: "+t.message)})}else this._clearSvgElement();this._usingFontIcon()&&this._updateFontIconClasses()},t.prototype.ngOnInit=function(){this._usingFontIcon()&&this._updateFontIconClasses()},t.prototype._usingFontIcon=function(){return!this.svgIcon},t.prototype._setSvgElement=function(t){this._clearSvgElement();for(var e=t.querySelectorAll("style"),n=0;n<e.length;n++)e[n].textContent+=" ";if(this._location){var o=this._location.getPathname();this._previousPath=o,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(o)}this._getHostElement().appendChild(t)},t.prototype._clearSvgElement=function(){var t=this._getHostElement(),e=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();e--;){var n=t.childNodes[e];1===n.nodeType&&"svg"!==n.nodeName.toLowerCase()||t.removeChild(n)}},t.prototype._updateFontIconClasses=function(){if(this._usingFontIcon()){var t=this._getHostElement(),e=this.fontSet?[this._iconRegistry.classNameForFontAlias(this.fontSet)]:this._iconRegistry.getDefaultFontSetClass();this._previousFontSetClass.forEach(function(e){return t.classList.remove(e)}),e.forEach(function(e){return t.classList.add(e)}),this._previousFontSetClass=e,this.fontIcon!==this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}},t.prototype._cleanupFontValue=function(t){return"string"==typeof t?t.trim().split(" ")[0]:t},t.prototype._prependPathToReferences=function(t){var e=this._elementsWithExternalReferences;e&&e.forEach(function(e,n){e.forEach(function(e){n.setAttribute(e.name,"url('"+t+"#"+e.value+"')")})})},t.prototype._cacheChildrenWithExternalReferences=function(t){for(var e=t.querySelectorAll(C),n=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map,o=function(t){y.forEach(function(o){var r=e[t],i=r.getAttribute(o),s=i?i.match(E):null;if(s){var a=n.get(r);a||(a=[],n.set(r,a)),a.push({name:o,value:s[1]})}})},r=0;r<e.length;r++)o(r)},t.prototype._getHostElement=function(){return this.elementRef.nativeElement},t.decorators=[{type:e.Component,args:[{selector:"mdc-icon, [mdcIcon]",exportAs:"mdcIcon",host:{"[attr.role]":"role","[attr.tabindex]":"tabIndex",class:"ngx-mdc-icon","[class.ngx-mdc-icon--clickable]":"clickable","[class.ngx-mdc-icon--inline]":"inline"},template:"<ng-content></ng-content>",encapsulation:e.ViewEncapsulation.None,changeDetection:e.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:e.ElementRef},{type:g},{type:String,decorators:[{type:e.Attribute,args:["aria-hidden"]}]},{type:void 0,decorators:[{type:e.Inject,args:[S]}]}]},t.propDecorators={inline:[{type:e.Input}],svgIcon:[{type:e.Input}],role:[{type:e.Input}],tabIndex:[{type:e.Input}],fontSet:[{type:e.Input}],fontIcon:[{type:e.Input}],clickable:[{type:e.Input}]},t}(),F=[b,c],w=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{exports:F,declarations:F}]}],t}();t.MdcIconModule=w,t.MDC_ICON_LOCATION_FACTORY=I,t.MDC_ICON_LOCATION=S,t.MdcIcon=b,t.getMdcIconNameNotFoundError=l,t.getMdcIconNoHttpProviderError=u,t.getMdcIconFailedToSanitizeUrlError=p,t.getMdcIconFailedToSanitizeLiteralError=h,t.ICON_REGISTRY_PROVIDER_FACTORY=d,t.MdcIconRegistry=g,t.ICON_REGISTRY_PROVIDER=m,t.MdcMaterialIcons=c,Object.defineProperty(t,"__esModule",{value:!0})});